var A=Object.defineProperty,D=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var U=(u,t,e)=>t in u?A(u,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):u[t]=e,d=(u,t)=>{for(var e in t||(t={}))L.call(t,e)&&U(u,e,t[e]);if(S)for(var e of S(t))B.call(t,e)&&U(u,e,t[e]);return u},r=(u,t)=>D(u,$(t));import{_ as N}from"./index.04101b15.js";import{d as b,r as V,q as p,J as R,o as k,g as m,e as n,H as j,G as q,u as _,t as G,k as H,b as h,w as f,a as I,f as J}from"./index.c7def661.js";const O={class:"iz-upload"},T={key:0,class:"iz-upload-progress"},K={name:"IzUploadChunk"},M=b(r(d({},K),{props:{url:{type:String,default:null},headers:{type:Object,default:()=>({})},size:{type:Number,default:5*1024*1024}},setup(u){const t=u,e=V({chunkFileCount:0,uploadSuccessFileCount:0,uploadUtil:0,chunkList:[],chunkUploadStatus:[]}),F=p(()=>e.chunkFileCount===0?"0%":(100*e.uploadSuccessFileCount/e.chunkFileCount).toFixed(2)+"%"),c=p(()=>e.chunkFileCount===e.uploadSuccessFileCount?"done":"uploading"),z=p(()=>c.value==="uploading"?"visibility: hidden":""),i=R(),E=()=>{var s;(s=i.value)==null||s.click()},C=(s,a)=>{const l=new FormData;l.append("file",s),fetch(t.url,{method:"post",headers:t.headers,body:l}).then(()=>{e.uploadSuccessFileCount++,e.chunkUploadStatus[a]=!0}).finally(()=>{e.uploadUtil+1<e.chunkList.length&&C(e.chunkList[++e.uploadUtil],e.uploadUtil)})},w=()=>{e.chunkFileCount=1,e.uploadSuccessFileCount=0},x=()=>{var v,y;w();const s=(y=(v=i.value)==null?void 0:v.files)==null?void 0:y[0],a=t.size,l=[],g=[];for(let o=0;o*a<s.size;)l.push(s.slice(o*a,++o*a)),g.push(!1);e.chunkList=l,e.chunkUploadStatus=g,e.chunkFileCount=l.length,e.uploadUtil=l.length>=30?29:l.length-1;for(let o=0;o<e.uploadUtil+1;o++)C(e.chunkList[o],o)};return(s,a)=>(k(),m("div",O,[n("div",{style:q(_(z)),class:"iz-upload-trigger",onClick:E},[j(s.$slots,"default")],4),_(c)==="uploading"?(k(),m("div",T,G(_(F)),1)):H("",!0),n("input",{ref_key:"uploadRef",ref:i,multiple:!1,type:"file",style:{display:"none"},onChange:x},null,544)]))}})),P={class:"page-md-editor"},Q=n("div",{class:"page-header"},[n("div",{class:"left"},[n("h2",null,"\u5206\u7247\u4E0A\u4F20"),n("p",null,"\u6F14\u793A\u5206\u7247\u4E0A\u4F20\u529F\u80FD\uFF0C\u53EA\u652F\u6301\u672C\u5730\u8FD0\u884C\uFF0C\u670D\u52A1\u7AEF\u5728mock\u4E2D\u5B9E\u73B0\u3002")])],-1),W={class:"view-space"},X=J("\u4E0A\u4F20"),Y="UploadSlice",Z={name:Y},se=b(r(d({},Z),{setup(u){const t="https://www.fastmock.site/mock/666b2bc3ee91f13644d96f70db736879/api//upload/chunk";return(e,F)=>{const c=I("el-button");return k(),m("div",P,[Q,n("div",W,[h(N,null,{default:f(()=>[h(M,{url:t},{default:f(()=>[h(c,null,{default:f(()=>[X]),_:1})]),_:1})]),_:1})])])}}}));export{se as default};
